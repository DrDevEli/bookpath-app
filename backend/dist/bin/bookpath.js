#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const environment_1 = require("../src/config/environment");
const bookpath_api_stack_1 = require("../src/stacks/bookpath-api-stack");
const app = new aws_cdk_lib_1.App();
const contextEnv = app.node.tryGetContext('env');
const envName = (0, environment_1.resolveEnvironment)(contextEnv ?? process.env.BOOKPATH_ENV);
const account = process.env.CDK_DEFAULT_ACCOUNT;
const region = process.env.CDK_DEFAULT_REGION ?? 'eu-central-1';
if (!account) {
    throw new Error('Missing CDK_DEFAULT_ACCOUNT. Run `cdk deploy` with a configured AWS profile or set explicit account/region.');
}
const env = { account, region };
new bookpath_api_stack_1.BookPathApiStack(app, `BookPathApi-${envName}`, {
    env,
    environmentName: envName,
    tags: {
        Project: 'BookPath',
        Environment: envName,
    },
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9va3BhdGguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9iaW4vYm9va3BhdGgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsdUNBQXFDO0FBQ3JDLDZDQUErQztBQUMvQywyREFBK0Q7QUFDL0QseUVBQW9FO0FBRXBFLE1BQU0sR0FBRyxHQUFHLElBQUksaUJBQUcsRUFBRSxDQUFDO0FBRXRCLE1BQU0sVUFBVSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBdUIsQ0FBQztBQUN2RSxNQUFNLE9BQU8sR0FBRyxJQUFBLGdDQUFrQixFQUFDLFVBQVUsSUFBSSxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBRTNFLE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUM7QUFDaEQsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsSUFBSSxjQUFjLENBQUM7QUFFaEUsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2IsTUFBTSxJQUFJLEtBQUssQ0FDYiw2R0FBNkcsQ0FDOUcsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLEdBQUcsR0FBZ0IsRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUM7QUFFN0MsSUFBSSxxQ0FBZ0IsQ0FBQyxHQUFHLEVBQUUsZUFBZSxPQUFPLEVBQUUsRUFBRTtJQUNsRCxHQUFHO0lBQ0gsZUFBZSxFQUFFLE9BQU87SUFDeEIsSUFBSSxFQUFFO1FBQ0osT0FBTyxFQUFFLFVBQVU7UUFDbkIsV0FBVyxFQUFFLE9BQU87S0FDckI7Q0FDRixDQUFDLENBQUM7QUFFSCxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIjIS91c3IvYmluL2VudiBub2RlXG5pbXBvcnQgJ3NvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3Rlcic7XG5pbXBvcnQgeyBBcHAsIEVudmlyb25tZW50IH0gZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0IHsgcmVzb2x2ZUVudmlyb25tZW50IH0gZnJvbSAnLi4vc3JjL2NvbmZpZy9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBCb29rUGF0aEFwaVN0YWNrIH0gZnJvbSAnLi4vc3JjL3N0YWNrcy9ib29rcGF0aC1hcGktc3RhY2snO1xuXG5jb25zdCBhcHAgPSBuZXcgQXBwKCk7XG5cbmNvbnN0IGNvbnRleHRFbnYgPSBhcHAubm9kZS50cnlHZXRDb250ZXh0KCdlbnYnKSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG5jb25zdCBlbnZOYW1lID0gcmVzb2x2ZUVudmlyb25tZW50KGNvbnRleHRFbnYgPz8gcHJvY2Vzcy5lbnYuQk9PS1BBVEhfRU5WKTtcblxuY29uc3QgYWNjb3VudCA9IHByb2Nlc3MuZW52LkNES19ERUZBVUxUX0FDQ09VTlQ7XG5jb25zdCByZWdpb24gPSBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9SRUdJT04gPz8gJ2V1LWNlbnRyYWwtMSc7XG5cbmlmICghYWNjb3VudCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgJ01pc3NpbmcgQ0RLX0RFRkFVTFRfQUNDT1VOVC4gUnVuIGBjZGsgZGVwbG95YCB3aXRoIGEgY29uZmlndXJlZCBBV1MgcHJvZmlsZSBvciBzZXQgZXhwbGljaXQgYWNjb3VudC9yZWdpb24uJyxcbiAgKTtcbn1cblxuY29uc3QgZW52OiBFbnZpcm9ubWVudCA9IHsgYWNjb3VudCwgcmVnaW9uIH07XG5cbm5ldyBCb29rUGF0aEFwaVN0YWNrKGFwcCwgYEJvb2tQYXRoQXBpLSR7ZW52TmFtZX1gLCB7XG4gIGVudixcbiAgZW52aXJvbm1lbnROYW1lOiBlbnZOYW1lLFxuICB0YWdzOiB7XG4gICAgUHJvamVjdDogJ0Jvb2tQYXRoJyxcbiAgICBFbnZpcm9ubWVudDogZW52TmFtZSxcbiAgfSxcbn0pO1xuXG5hcHAuc3ludGgoKTtcblxuIl19